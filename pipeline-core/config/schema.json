{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RNASEQ-MINI Configuration Schema",
  "description": "Schema for validating the config/params.yaml file",
  "type": "object",
  "properties": {
    "pipeline": { "$ref": "#/definitions/pipeline" },
    "tools": { "$ref": "#/definitions/tools" },
    "execution": { "$ref": "#/definitions/execution" },
    "advanced": { "$ref": "#/definitions/advanced" }
  },
  "required": ["pipeline", "tools", "execution"],
  
  "definitions": {
    "pipeline": {
      "type": "object",
      "properties": {
        "project": { "type": "string" },
        "se": { "type": "boolean" },
        "organism": { "type": "string" },
        "references": {
          "type": "object",
          "properties": {
            "auto_download": { "type": "boolean" },
            "species": { "type": "string" }
          }
        },
        "report": {
          "type": "object",
          "properties": {
            "author": { "type": "string" },
            "title": { "type": "string" },
            "output_html": { "type": "string" }
          }
        },
        "fastq_dir": { "type": "string" },
        "paths": {
          "type": "object",
          "properties": {
            "samples": { "type": "string", "format": "path" },
            "outdir": { "type": "string" },
            "logs": { "type": "string" }
          },
          "required": ["samples", "outdir"]
        }
      },
      "required": ["project", "se", "organism", "references", "paths"]
    },
    "tools": {
      "type": "object",
      "properties": {
        "fastqc": {
          "type": "object",
          "properties": { "extra": { "type": "string" } }
        },
        "multiqc": {
          "type": "object",
          "properties": { "title": { "type": "string" } }
        },
        "salmon": {
          "type": "object",
          "properties": {
            "libtype": { "type": "string" },
            "extra": { "type": "string" },
            "threads": { "type": "integer", "minimum": 1 }
          },
          "required": ["libtype", "threads"]
        },
        "r": {
          "type": "object",
          "properties": {
            "design": { "type": "string" },
            "contrasts_file": { "type": "string", "format": "path" }
          },
          "required": ["design", "contrasts_file"]
        },
        "fgsea": {
          "type": "object",
          "properties": {
            "genesets": { "type": ["string", "null"], "format": "path" }
          }
        }
      }
    },
    "execution": {
      "type": "object",
      "properties": {
        "threads": { "type": "integer", "minimum": 1 },
        "memory_gb": { "type": "integer", "minimum": 1 },
        "containers": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "image": { "type": "string" }
          }
        },
        "profiles": {
            "type": "object",
            "properties": {
                "snakemake": {"type": "string"}
            }
        },
        "resource_profiles": { "type": "object" }
      },
      "required": ["threads", "memory_gb"]
    },
    "advanced": {
      "type": "object",
      "properties": {
        "cache": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "dir": { "type": "string" },
            "max_age_days": { "type": "integer", "minimum": 0 }
          }
        },
        "singlecell": { "type": "object" },
        "optimization": { "type": "object" },
        "error_handling": { "type": "object" },
        "troubleshooting": { "type": "object" }
      }
    }
  }
}
